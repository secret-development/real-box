<h1 class="title-page"><%= @title %></h1>
<%= flash_msg(flash[:notice]) %>
<%= link_to plus_icon + 'Добавить', new_task_path, 
    :class => "btn button-add"  %>

<table class="table table-striped table-condensed tasks">
  <thead>
    <tr>
      <th>#</th>
      <th>Задача</th>
      <th>Описание</th>
      <th>Ответственный</th>
      <th>Дедлайн</th>
      <th>Сделано</th>
      <th>Дата постановки</th>
      <th>Операции</th>
    </tr>
  </thead>
  
  <tbody>
    <% @tasks.each do |task| %>
      <tr>
        <td><%= task.id %></td>
        <td><%= link_to task.title, task_path(task) %></td>
        <td><%= truncate(task.description, :length => 50, 
                        :omission => '...') %></td>
        <td><%= link_to task.user.short_name, user_path(task.user) %></td>
        <td><%= to_datetime(task.deadline) %></td>
        <td> 
          <div class="btn-group">
            <a class="btn" href="#">
              <%= task.status %>
            </a>
            <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
              <%= link_to "Задача не выполнена", task_path(task, 
                        :task => { :done => false }),
                        :method => :put, 
                        :confirm => "Вы уверены?" %>
              <%= link_to "Задача выполнена", task_path(task, 
                                  :task => { :done => true}),
                                  :method => :put, 
                                  :confirm => "Вы уверены?" %>
            </ul>
          </div>
            
        </td>
        <td><%= to_datetime(task.created_at) %></td>
        <td>
          <%= link_to eye_icon, task_path(task) %>
          <%= link_to edit_icon, edit_task_path(task) %>
          <%= link_to delete_icon, task, :method => :delete,
                      :confirm => "Вы уверены?" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
