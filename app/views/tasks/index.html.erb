<h1 class="title-page"><%= @title %></h1>
<%= flash_msg(flash[:notice]) %>

<table class="table table-striped table-condensed tasks">
  <thead>
    <tr>
      <th>#</th>
      <th>Задача</th>
      <th>Описание</th>
      <th>Ответственный</th>
      <th>Дедлайн</th>
      <th>Сделано</th>
      <th>Дата постановки</th>
      <th>Операции</th>
    </tr>
  </thead>
  
  <tbody>
    <% @tasks.each do |task| %>
      <tr>
        <td><%= task.id %></td>
        <td><%= link_to task.title, task_path(task) %></td>
        <td><%= truncate(task.description, :length => 50, 
                        :omission => '...') %></td>
        <td><%= link_to task.user.full_name, user_path(task.user) %></td>
        <td><%= task.deadline.strftime('%d.%m.%Y %H:%M:%S') %></td>
        <td>
          <%= task.status %> | 
          <% if task.done == true %>
            <%= link_to "Изменить", task_path(task, 
                      :task => { :done => false }),
                      :method => :put, 
                      :confirm => "Вы уверены?" %>
          <% else %>
            <%= link_to "Изменить", task_path(task, 
                                :task => { :done => true}),
                                :method => :put, 
                                :confirm => "Вы уверены?" %>
          <% end %>
        </td>
        <td><%= task.created_at.strftime('%d.%m.%Y %H:%M:%S') %></td>
        <td>
          <%= link_to eye_icon, task_path(task) %>
          <%= link_to edit_icon, edit_task_path(task) %>
          <%= link_to delete_icon, task, :method => :delete,
                      :confirm => "Вы уверены?" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
